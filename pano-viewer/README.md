# 全景图编辑器

一个基于 Marzipano 的现代化全景图上传、编辑和展示应用，参考 720云 的界面设计和功能。

## ✨ 功能特性

### 🖼️ 场景管理
- **上传全景图**：支持拖拽上传或点击选择
- **多场景支持**：可以上传多个全景图场景
- **场景切换**：点击左侧场景列表快速切换
- **场景编辑**：重命名场景、删除场景
- **自动识别**：自动识别等矩形(2:1)或立方体格式全景图

### 🎮 查看控制
- **交互式浏览**：鼠标拖动旋转，滚轮缩放
- **自动旋转**：一键启用自动旋转浏览
- **全屏模式**：支持全屏沉浸式体验
- **平滑过渡**：场景切换带有流畅的过渡动画

### 📍 热点功能
- **信息热点**：添加带有标题和内容的信息点
- **场景链接**：创建场景之间的导航链接
- **图片热点**：添加图片展示热点
- **热点管理**：在属性面板管理和删除热点
- **智能定位**：热点自动添加在当前视角中心

### 💾 数据管理
- **会话保存**：图片在当前浏览器会话中保持
- **配置持久化**：场景名称、热点配置自动保存到本地存储
- **刷新提示**：刷新页面后需要重新上传图片，但热点配置会保留
- **轻量存储**：避免LocalStorage容量限制问题

### 🎨 现代化界面
- **响应式设计**：适配不同屏幕尺寸
- **直观布局**：清晰的三栏式布局（场景列表 / 查看器 / 属性面板）
- **美观交互**：流畅的动画和现代化的UI组件
- **深色主题**：查看器区域采用深色背景，突出全景内容

## 🚀 使用方法

### 1. 启动应用

确保已经构建了 Marzipano 库：

```bash
# 如果还没有构建，先运行：
npx browserify -d -s Marzipano -o build/marzipano.js src/index.js
```

然后访问应用：

```
http://localhost:8080/pano-viewer/
```

### 2. 上传全景图

**方式一：拖拽上传**
- 将全景图文件拖拽到左侧上传区域

**方式二：点击上传**
- 点击上传区域或"上传全景图"按钮
- 选择一个或多个全景图文件

**支持的格式：**
- JPG / JPEG
- PNG

**推荐规格：**
- 等矩形全景：4096x2048 或更高 (2:1 比例)
- 立方体全景：自动识别并处理

### 3. 浏览全景图

**基本操作：**
- **旋转视角**：按住鼠标左键拖动
- **缩放**：滚动鼠标滚轮
- **切换场景**：点击左侧场景列表中的缩略图

**控制功能：**
- 🔄 **自动旋转**：启用后自动旋转全景
- ⛶ **全屏**：进入/退出全屏模式
- 📍 **添加热点**：在当前视角添加热点
- ⚙️ **设置**：打开属性面板

### 4. 添加热点

1. 浏览到想要添加热点的位置
2. 点击底部控制栏的"添加热点"按钮（📍）
3. 在弹出的对话框中：
   - 选择热点类型（信息/场景链接/图片）
   - 输入热点标题
   - 填写相应的内容或选择链接场景
4. 点击"确定"完成添加

**热点类型说明：**
- **信息热点** (ℹ️)：显示文字信息
- **场景链接** (🚪)：点击后跳转到其他场景
- **图片热点** (🖼️)：显示图片内容

### 5. 管理场景和热点

**编辑场景：**
- 点击场景右侧的编辑按钮（✏️）打开属性面板
- 在属性面板中修改场景名称
- 修改初始视角参数

**删除场景：**
- 点击场景右侧的删除按钮（🗑️）
- 确认删除操作

**管理热点：**
- 打开属性面板查看当前场景的所有热点
- 点击热点右侧的删除按钮移除热点

## 📋 技术栈

- **核心库**：Marzipano.js - Google 开发的 360° 全景查看器
- **原生技术**：HTML5 + CSS3 + JavaScript (ES6+)
- **存储**：LocalStorage API
- **文件处理**：FileReader API

## 🎯 应用场景

- 房产展示：虚拟看房
- 旅游景点：线上游览
- 博物馆：数字化展览
- 商业空间：店铺展示
- 教育培训：虚拟实验室
- 活动记录：全景摄影作品

## ⚙️ 配置说明

### 存储策略说明

**会话存储（Session）：**
- 图片数据保存在浏览器会话中
- 关闭标签页后数据会丢失
- 支持任意大小的全景图

**本地存储（LocalStorage）：**
- 场景名称和结构配置
- 热点位置和配置信息
- 刷新页面后配置会保留

**建议：**
- 保持浏览器标签页打开以维持图片数据
- 定期导出重要的热点配置
- 单次工作完成后建议导出项目

### 浏览器兼容性

- ✅ Chrome 60+
- ✅ Firefox 55+
- ✅ Safari 11+
- ✅ Edge 79+

### 性能优化建议

1. **图片优化**：使用合适的压缩率
2. **场景数量**：建议不超过 20 个场景
3. **热点数量**：单个场景建议不超过 50 个热点

## 🐛 常见问题

**Q: 上传图片后看不到内容？**
A: 检查图片格式是否正确，建议使用 2:1 比例的等矩形全景图。

**Q: 刷新页面后图片消失了？**
A: 这是正常的。为避免存储空间限制，图片仅在当前会话中保持。热点配置会自动保存，重新上传图片后热点会恢复。

**Q: 热点不显示？**
A: 确保已经选择了当前场景，热点只显示在对应的场景中。

**Q: 如何保存我的项目？**
A: 场景名称和热点配置会自动保存。图片需要您手动保管，建议将使用的全景图保存在本地文件夹中。

**Q: 支持多大的图片？**
A: 由于使用会话存储，理论上支持任意大小的图片。但建议单张不超过10MB以获得更好的加载性能。

## 📝 开发说明

### 项目结构

```
pano-viewer/
├── index.html      # 主HTML文件
├── style.css       # 样式文件
├── app.js          # 应用逻辑
└── README.md       # 说明文档
```

### 扩展功能建议

- [ ] 添加更多热点样式和动画
- [ ] 支持视频全景
- [ ] 导出项目为HTML文件
- [ ] 添加更多编辑工具
- [ ] 支持音频背景
- [ ] 分享功能
- [ ] 云端存储集成

## 📄 许可证

基于 Marzipano (Apache-2.0) 开发

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

**提示**：这是一个演示应用，如需用于生产环境，建议：
1. 使用服务器端存储
2. 添加用户认证
3. 实现项目导出/导入
4. 优化图片处理流程
